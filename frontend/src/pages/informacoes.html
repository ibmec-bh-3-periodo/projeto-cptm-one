<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Document</title>
<link rel="stylesheet" href="/css/informacoes.css">
<style>
  .popup {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 9999;
  }
  .popup-content {
    background: #fff; padding: 30px; border-radius: 10px; min-width: 300px; text-align: center; position: relative;
  }
  .loading-bar {
    width: 100%; background: #eee; height: 20px; border-radius: 10px; margin: 20px 0;
  }
  .loading-progress {
    height: 100%; width: 0%; background: #009CA6; border-radius: 10px; transition: width 0.3s;
  }
</style>
</head>
<body>
  <div class="app-container">
    <header>
      <div class="logo"><a href="/pages/home.html"><img src="/images/imghome/logo.png" alt=""></a></div>
      <div class="settings"><img src="/images/imghome/configuracao (1).png" alt=""></div>
    </header>
    <div class="tudo">
      <section>
        <h1>SISTEMA DE INTERVALOS</h1>
        <p>Selecione a linha e confira os intervalos médios programados entre os trens.</p>
      </section>
      <main>
        <div class="linha" style="background-color: #A50034;">7 <span>Rubi</span></div>
        <div class="linha" style="background-color: #009CA6;">10 <span>Turquesa</span></div>
        <div class="linha" style="background-color: #F58220;">11 <span>Coral</span></div>
        <div class="linha" style="background-color: #002776;">12 <span>Safira</span></div>
        <div class="linha" style="background-color: #00A859;">13 <span>Jade</span></div>
        <div class="linha" style="background-color: #000000;">710 <span>Serviço</span></div>
      </main>
    </div>
    <div class="infobaixo">
      <p>A CPTM mantém as estações em funcionamento de todos os dias da semana, das 4h à meia-noite.</p>
      <p>A transferência entre linhas é garantida desde que o passageiro esteja em sua última estação de transferência até a 0h.</p>
      <p>O intervalo máximo entre trens aos fins de semana e feriados é de 35 minutos.</p>
    </div>

    <!-- Principal -->
    <section class="info"></section>
    <div class="espacar"></div>

    <!-- Bottom Navigation -->
    <footer>
      <a href="/pages/pagamento.html">
        <div class="saldo">
        <img src="/images/imghome/compras (2).png" alt="">
        </div>
      </a>
      <a href="/pages/home.html">
        <div class="home">
        <img src="/images/imghome/casa (3).png" alt="">
        </div>
      </a>  
      <a href="/pages/perfil.html">
        <div class="perfil">
        <img src="/images/imghome/solteiro (2).png" alt="">
        </div>
      </a>
    </footer>
  </div>

  <!-- Popup dentro do body -->
  <div id="popup" class="popup" style="display:none;">
    <div class="popup-content">
    <span id="close-popup" style="cursor:pointer;float:right;font-size:24px;">&times;</span>
    <h2 id="popup-title"></h2>
    <div class="loading-bar">
      <div class="loading-progress" id="loading-progress"></div>
    </div>
    <p id="popup-message"></p>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const temposLinha = {
    'Rubi': 300,
    'Turquesa': 230,
    'Coral': 1000,
    'Safira': 1213,
    'Jade': 58567,
    'Serviço': 741
  };

  document.querySelectorAll('.linha').forEach(div => {
    div.addEventListener('click', function() {
      const nomeLinha = this.querySelector('span').innerText.trim();
      const tempo = temposLinha[nomeLinha] || 3;

      document.getElementById('popup').style.display = 'flex';
      document.getElementById('popup-title').innerText = `Linha ${this.innerText.trim()}`;
      let progress = 0;
      const loading = document.getElementById('loading-progress');
      loading.style.width = '0%';

      const totalMs = tempo * 1000; // para produção use tempo * 60000
      const steps = 100;
      const stepMs = totalMs / steps;
      let elapsed = 0;

      const interval = setInterval(() => {
        progress += 1;
        elapsed += stepMs;
        loading.style.width = progress + '%';

        // Tempo restante em segundos
        const tempoRestante = Math.ceil((totalMs - elapsed) / 1000);
        if (tempoRestante > 0) {
          document.getElementById('popup-message').innerText = 
            `Próximo trem chega em ${tempoRestante} segundo${tempoRestante > 1 ? 's' : ''}!`;
        } else {
          document.getElementById('popup-message').innerText = `Próximo trem chegou!`;
        }

        if (progress >= 100) {
          clearInterval(interval);
          document.getElementById('popup-message').innerText = `Próximo trem chegou!`;
        }
      }, stepMs);
    });
  });

  document.getElementById('close-popup').onclick = function() {
    document.getElementById('popup').style.display = 'none';
    document.getElementById('loading-progress').style.width = '0%';
    document.getElementById('popup-message').innerText = '';
  };
});
</script>
</body>
</html>